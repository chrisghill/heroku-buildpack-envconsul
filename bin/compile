#!/bin/sh

echo "-----> Downloading envconsul binary"
curl -sSL https://releases.hashicorp.com/envconsul/0.9.3/envconsul_0.9.3_linux_amd64.zip > envconsul.zip
echo "-----> Extracting..."
unzip envconsul.zip
rm envconsul.zip
mv envconsul $1
echo "-----> envconsul installed!"
echo "-----> decoding Vault CA cert..."
echo -n LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURNakNDQWhxZ0F3SUJBZ0lRYk9JekpoNk82WTdUYkxuZERaTHQxVEFOQmdrcWhraUc5dzBCQVFzRkFEQXoKTVJnd0ZnWURWUVFLRXc5SVlYTm9hVU52Y25BZ1ZtRjFiSFF4RnpBVkJnTlZCQU1URG5aaGRXeDBMV05oTG14dgpZMkZzTUI0WERUSXdNRFl4TWpJeE16TXpPRm9YRFRJeE1EWXhNakl4TXpNek9Gb3dNekVZTUJZR0ExVUVDaE1QClNHRnphR2xEYjNKd0lGWmhkV3gwTVJjd0ZRWURWUVFERXc1MllYVnNkQzFqWVM1c2IyTmhiRENDQVNJd0RRWUoKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS2t6Sm14V0VMVXVGZ0wrNDUrTjE0ckRheFdadFd3dApnTTVLUjRBS1QxQlFDeTllQVRiMHp0b3dOOHA1RzZjdi9JbmR6ZTNrdFdVUzdUdnNRcjFuS2JUUXhJdnI4QSsxCnljUGFDaWlMQzlUMW82VzBOZmpreW5PQWtxK3dDVkdYd3pzQlRYSlRMeVhUZHgvK25aak9pbm45R1p0emtuSnUKTTJiNEJiUkhYUWhLVktZOUl1K3d4bER2SGRtNVJDY3RUaTlJbG8wcXR0VWlCZjYyOFBLUk00Z04zWHprVVRBTQptTUk4bGx2TTREMjBkSkdXa3FUU0p2dWVVSWNlK2h4V2VtMVlpb0srOGxEMFRvUzA3Qkw0clQxR0ZDbWJtaU1YCnlGQms1ZjBMY1FUNDVZNFNzVktuRlp6NEJaR3R3RHFOeTdDNSsrUUxPZmpxR1c3bjlYT3VTbmNDQXdFQUFhTkMKTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRk8yOQp6UzBIRDhsMzJ4VVFrRGRuejZqaG5OMXFNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFqM29QSjgzbTdaUU9WCi84STFrRVBUc3NCVnNqMSs2RGZKR29odG9JTUFkdHNFQjM5OHhjTGpJelZDL3dQaHN2d0xmUDF2cW5GdTJSR2oKZkRqVExMaWFreERXSnM0d1ZpWjRNWUxXRGlWOGZlektYcGFnNG1JN0tOeDk0NmU5aHNSTHc4QktUcXNZbFBXLwpkVDczVittVUdadjk0VW1paWhpZVNqTmpzR0hORjVmK1h6d3RKLzRuN1Y4MFRqa2tOaFd4dU82UjZ2ckpGVDdMClkzdUtTSkpqNFo0OEQzQXdubWp0WnRJc2h0dUxHVlVnSEp0aWhPWFpVS1phNDhyR1hRNzRqWTMzTVo5aDdLc1cKalRpRG0wVkMyVXNSdmZFQlJybzdoanBTZ3pXZjhVOHp2eGE0S2F2dEU1REV0bEIxeWVvcVlSbGZyZDFoU0NDVgo5VnVIdWRnRQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCgo= | base64 -d > vault_ca_cert.pem
echo "-----> Vault CA cert decoded"
